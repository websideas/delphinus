/* NM: Single product script */
(function(b){b.extend(b.nmTheme,{singleProduct_init:function(){this.singleProductVariationsInit();this.shopInitQuantity(b("#nm-product-summary"));this.singleProductGalleryInit();var a=b("#nm-comment-form-rating");a.on("click.nmAddParentClass",".stars a",function(){a.children(".stars").addClass("has-active")});var g=b("#nm-upsells").find(".nm-shop-loop-thumbnail .unveil-image"),d=b("#nm-related").find(".nm-shop-loop-thumbnail .unveil-image"),e=b.merge(g,d);this.$window.load(function(){e.length&&e.unveil(1,
function(){b(this).parents("li").first().addClass("image-loaded")})})},singleProductVariationsInit:function(){var a=this;a.$variationsForm=b("#nm-variations-form");a.$variationsWrap=a.$variationsForm.children(".variations");a.$variationsWrap.find("select").selectOrDie(a.shopSelectConfig);a.shopToggleVariationDetails();a.$variationsForm.on("found_variation",function(){a.shopToggleVariationDetails()});a.$variationsForm.on("woocommerce_variation_select_change",function(){a.$productImageSlider.length&&
a.$productImageSlider.slick("slickGoTo",0,!1)})},singleProductGalleryInit:function(){var a=this;if(b("#nm-page-includes").hasClass("product-gallery")){a.$productImageSlider=b("#nm-product-images-slider");var g=a.$productImageSlider.children("div"),d=b("#nm-product-thumbnails-slider"),e=d.children("div"),m=e.first(),f=e.length,f=6<f?6:f,h=!1;a.$productImageSlider.on("init",function(){g.bind("click",function(b){a.$productImageSlider.hasClass("animating")||(b.preventDefault(),n(this))})});a.$productImageSlider.on("beforeChange",
function(b,e,k,g){h||d.find(".slick-slide").eq(g).trigger("click");h=!1;a.$productImageSlider.addClass("animating")});a.$productImageSlider.on("afterChange",function(){a.$productImageSlider.removeClass("animating")});a.$productImageSlider.slick({adaptiveHeight:!0,slidesToShow:1,slidesToScroll:1,prevArrow:'<a class="slick-prev"><i class="nm-font nm-font-play flip"></i></a>',nextArrow:'<a class="slick-next"><i class="nm-font nm-font-play"></i></a>',dots:!0,fade:!0,cssEase:"linear",infinite:!1,speed:300});
d.on("init",function(){e.bind("click",function(){var c=b(this);a.$productImageSlider.hasClass("animating")||c.hasClass("current")||(h=!0,m.removeClass("current"),c.addClass("current"),m=c,c.next().hasClass("slick-active")?c.prev().hasClass("slick-active")||d.slick("slickPrev"):d.slick("slickNext"),a.$productImageSlider.slick("slickGoTo",c.index(),!1))})});d.slick({slidesToShow:f,slidesToScroll:1,arrows:!1,infinite:!1,focusOnSelect:!1,vertical:!0,draggable:!1,speed:300,swipe:!1,touchMove:!1});var n=
function(c){c=b(c).index();var e,k,f,h=[],p,m;g.each(function(){e=b(this);k=e.children("a");f=k.children("img");p=k.data("size").split("x");m={src:k.attr("href"),w:parseInt(p[0],10),h:parseInt(p[1],10),msrc:f.attr("src"),el:k[0]};h.push(m)});var l={index:c,showHideOpacity:!0,bgOpacity:.86,loop:!1,mainClass:"pswp--minimal--dark",barsSize:{top:0,bottom:0},captionEl:!1,fullscreenEl:!1,zoomEl:!1,shareE1:!1,counterEl:!1,tapToClose:!0,tapToToggleControls:!1},n=b("#pswp")[0],l=new PhotoSwipe(n,PhotoSwipeUI_Default,
h,l);l.init();l.listen("initialZoomIn",function(){d.slick("slickSetOption","speed",0)});var q=c;l.listen("beforeChange",function(b){q+=b;a.$productImageSlider.slick("slickGoTo",q,!0)});l.listen("close",function(){d.slick("slickSetOption","speed",300)})}}}});b.nmThemeExtensions.singleProduct=b.nmTheme.singleProduct_init})(jQuery);