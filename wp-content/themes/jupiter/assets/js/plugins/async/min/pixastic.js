var Pixastic=function(){function t(t,e,a){t.addEventListener?t.addEventListener(e,a,!1):t.attachEvent&&t.attachEvent("on"+e,a)}function e(e){var a=!1,i=function(){a||(a=!0,e())};document.write('<script defer src="//:" id="__onload_ie_pixastic__"></script>');var n=document.getElementById("__onload_ie_pixastic__");n.onreadystatechange=function(){"complete"==n.readyState&&(n.parentNode.removeChild(n),i())},document.addEventListener&&document.addEventListener("DOMContentLoaded",i,!1),t(window,"load",i)}function a(){for(var t=n("pixastic",null,"img"),e=n("pixastic",null,"canvas"),a=t.concat(e),i=0;i<a.length;i++)!function(){for(var t=a[i],e=[],n=t.className.split(" "),r=0;r<n.length;r++){var s=n[r];if("pixastic-"==s.substring(0,9)){var o=s.substring(9);""!=o&&e.push(o)}}if(e.length)if("img"==t.tagName.toLowerCase()){var c=new Image;if(c.src=t.src,c.complete)for(var l=0;l<e.length;l++){var d=Pixastic.applyAction(t,t,e[l],null);d&&(t=d)}else c.onload=function(){for(var a=0;a<e.length;a++){var i=Pixastic.applyAction(t,t,e[a],null);i&&(t=i)}}}else setTimeout(function(){for(var a=0;a<e.length;a++){var i=Pixastic.applyAction(t,t,e[a],null);i&&(t=i)}},1)}()}function n(t,e,a){var n=new Array;null==e&&(e=document),null==a&&(a="*");var r=e.getElementsByTagName(a),s=r.length,o=new RegExp("(^|\\s)"+t+"(\\s|$)");for(i=0,j=0;i<s;i++)o.test(r[i].className)&&(n[j]=r[i],j++);return n}function r(t,e){if(Pixastic.debug)try{switch(e){case"warn":console.warn("Pixastic:",t);break;case"error":console.error("Pixastic:",t);break;default:console.log("Pixastic:",t)}}catch(a){}}"undefined"!=typeof pixastic_parseonload&&pixastic_parseonload&&e(a);var s=function(){var t=document.createElement("canvas"),e=!1;try{e=!("function"!=typeof t.getContext||!t.getContext("2d"))}catch(a){}return function(){return e}}(),o=function(){var t,e=document.createElement("canvas"),a=!1;try{"function"==typeof e.getContext&&(t=e.getContext("2d"))&&(a="function"==typeof t.getImageData)}catch(i){}return function(){return a}}(),c=function(){var t=!1,e=document.createElement("canvas");if(s()&&o()){e.width=e.height=1;var a=e.getContext("2d");a.fillStyle="rgb(255,0,0)",a.fillRect(0,0,1,1);var i=document.createElement("canvas");i.width=i.height=1;var n=i.getContext("2d");n.fillStyle="rgb(0,0,255)",n.fillRect(0,0,1,1),a.globalAlpha=.5,a.drawImage(i,0,0);var r=a.getImageData(0,0,1,1).data;t=255!=r[2]}return function(){return t}}();return{parseOnLoad:!1,debug:!1,applyAction:function(t,e,a,i){i=i||{};var n="canvas"==t.tagName.toLowerCase();if(n&&Pixastic.Client.isIE())return Pixastic.debug&&r("Tried to process a canvas element but browser is IE."),!1;var s,o,c=!1;Pixastic.Client.hasCanvas()&&(c=!!i.resultCanvas,s=i.resultCanvas||document.createElement("canvas"),o=s.getContext("2d"));var l=t.offsetWidth,d=t.offsetHeight;if(n&&(l=t.width,d=t.height),0==l||0==d){if(null!=t.parentNode)return void(Pixastic.debug&&r("Image has 0 width and/or height."));var g=t.style.position,h=t.style.left;t.style.position="absolute",t.style.left="-9999px",document.body.appendChild(t),l=t.offsetWidth,d=t.offsetHeight,document.body.removeChild(t),t.style.position=g,t.style.left=h}if(a.indexOf("(")>-1){var p=a;a=p.substr(0,p.indexOf("("));var u=p.match(/\((.*?)\)/);if(u[1]){u=u[1].split(";");for(var f=0;f<u.length;f++)if(thisArg=u[f].split("="),2==thisArg.length)if("rect"==thisArg[0]){var x=thisArg[1].split(",");i[thisArg[0]]={left:parseInt(x[0],10)||0,top:parseInt(x[1],10)||0,width:parseInt(x[2],10)||0,height:parseInt(x[3],10)||0}}else i[thisArg[0]]=thisArg[1]}}i.rect?(i.rect.left=Math.round(i.rect.left),i.rect.top=Math.round(i.rect.top),i.rect.width=Math.round(i.rect.width),i.rect.height=Math.round(i.rect.height)):i.rect={left:0,top:0,width:l,height:d};var _=!1;if(Pixastic.Actions[a]&&"function"==typeof Pixastic.Actions[a].process&&(_=!0),!_)return Pixastic.debug&&r('Invalid action "'+a+'". Maybe file not included?'),!1;if(!Pixastic.Actions[a].checkSupport())return Pixastic.debug&&r('Action "'+a+'" not supported by this browser.'),!1;Pixastic.Client.hasCanvas()?(s!==t&&(s.width=l,s.height=d),c||(s.style.width=l+"px",s.style.height=d+"px"),o.drawImage(e,0,0,l,d),t.__pixastic_org_image?(s.__pixastic_org_image=t.__pixastic_org_image,s.__pixastic_org_width=t.__pixastic_org_width,s.__pixastic_org_height=t.__pixastic_org_height):(s.__pixastic_org_image=t,s.__pixastic_org_width=l,s.__pixastic_org_height=d)):Pixastic.Client.isIE()&&"undefined"==typeof t.__pixastic_org_style&&(t.__pixastic_org_style=t.style.cssText);var v={image:t,canvas:s,width:l,height:d,useData:!0,options:i},m=Pixastic.Actions[a].process(v);return m?Pixastic.Client.hasCanvas()?(v.useData&&Pixastic.Client.hasCanvasImageData()&&(s.getContext("2d").putImageData(v.canvasData,i.rect.left,i.rect.top),s.getContext("2d").fillRect(0,0,0,0)),i.leaveDOM||(s.title=t.title,s.imgsrc=t.imgsrc,n||(s.alt=t.alt),n||(s.imgsrc=t.src),s.className=t.className,s.style.cssText=t.style.cssText,s.name=t.name,s.tabIndex=t.tabIndex,s.id=t.id,t.parentNode&&t.parentNode.replaceChild&&t.parentNode.replaceChild(s,t)),i.resultCanvas=s,s):t:!1},prepareData:function(t,e){var a=t.canvas.getContext("2d"),i=t.options.rect,n=a.getImageData(i.left,i.top,i.width,i.height),r=n.data;return e||(t.canvasData=n),r},process:function(t,e,a,i){if("img"==t.tagName.toLowerCase()){var n=new Image;if(n.src=t.src,n.complete){var r=Pixastic.applyAction(t,n,e,a);return i&&i(r),r}n.onload=function(){var r=Pixastic.applyAction(t,n,e,a);i&&i(r)}}if("canvas"==t.tagName.toLowerCase()){var r=Pixastic.applyAction(t,t,e,a);return i&&i(r),r}},revert:function(t){if(Pixastic.Client.hasCanvas()){if("canvas"==t.tagName.toLowerCase()&&t.__pixastic_org_image)return t.width=t.__pixastic_org_width,t.height=t.__pixastic_org_height,t.getContext("2d").drawImage(t.__pixastic_org_image,0,0),t.parentNode&&t.parentNode.replaceChild&&t.parentNode.replaceChild(t.__pixastic_org_image,t),t}else Pixastic.Client.isIE()&&"undefined"!=typeof t.__pixastic_org_style&&(t.style.cssText=t.__pixastic_org_style)},Client:{hasCanvas:s,hasCanvasImageData:o,hasGlobalAlpha:c,isIE:function(){return!!document.all&&!!window.attachEvent&&!window.opera}},Actions:{}}}();Pixastic.Actions.blurfast={process:function(t){var e=parseFloat(t.options.amount)||0,a=!(!t.options.clear||"false"==t.options.clear);if(e=Math.max(0,Math.min(5,e)),Pixastic.Client.hasCanvas()){var i=t.options.rect,n=t.canvas.getContext("2d");n.save(),n.beginPath(),n.rect(i.left,i.top,i.width,i.height),n.clip();var r=2,s=Math.round(t.width/r),o=Math.round(t.height/r),c=document.createElement("canvas");c.width=s,c.height=o;for(var a=!1,l=Math.round(20*e),d=c.getContext("2d"),g=0;l>g;g++){var h=Math.max(1,Math.round(s-g)),p=Math.max(1,Math.round(o-g));d.clearRect(0,0,s,o),d.drawImage(t.canvas,0,0,t.width,t.height,0,0,h,p),a&&n.clearRect(i.left,i.top,i.width,i.height),n.drawImage(c,0,0,h,p,0,0,t.width,t.height)}return n.restore(),t.useData=!1,!0}if(Pixastic.Client.isIE()){var u=10*e;return t.image.style.filter+=" progid:DXImageTransform.Microsoft.Blur(pixelradius="+u+")",t.options.fixMargin,t.image.style.marginLeft=(parseInt(t.image.style.marginLeft,10)||0)-Math.round(u)+"px",t.image.style.marginTop=(parseInt(t.image.style.marginTop,10)||0)-Math.round(u)+"px",!0}},checkSupport:function(){return Pixastic.Client.hasCanvas()||Pixastic.Client.isIE()}};