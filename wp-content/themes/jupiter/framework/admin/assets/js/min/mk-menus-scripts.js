!function(e){"use strict";function i(){var i,t;e(document.body).on("click.mkOpenMediaManager",".mk-open-media",function(a){return a.preventDefault(),t=this.id.replace("mk-media-upload-",""),i?void i.open():(i=wp.media.frames.MkMediaFrame=wp.media({className:"media-frame mk-media-frame",frame:"select",multiple:!1,library:{type:"image"}}),i.on("select",function(){var a=i.state().get("selection").first().toJSON();e("#edit-menu-item-megamenu-background-"+t).val(a.url),e("#mk-media-img-"+t).attr("src",a.url).css("display","block")}),void i.open())})}function t(){jQuery(".mk-visual-selector").find("a").each(function(){default_value=jQuery(this).siblings("input").val(),jQuery(this).attr("rel")==default_value&&jQuery(this).addClass("current"),jQuery(this).click(function(){return jQuery(this).siblings("input").val(jQuery(this).attr("rel")),jQuery(this).parent(".mk-visual-selector").find(".current").removeClass("current"),jQuery(this).addClass("current"),!1})})}function a(){jQuery(".mk-add-icon-btn").on("click",function(){this_el_id="#edit-menu-item-menu-icon-"+jQuery(this).attr("data-id"),icon_el_id="#mk-view-icon-"+jQuery(this).attr("data-id"),jQuery(".mk-icon-use-this").on("click",function(){return icon_value=jQuery("#mk-icon-value-holder").val(),""==icon_value?(jQuery(icon_el_id).attr("class",""),jQuery(this_el_id).val("")):(jQuery(icon_el_id).attr("class",icon_value),jQuery(this_el_id).val(icon_value)),window.parent.tb_remove(),!1})}),jQuery(".mk-remove-icon").on("click",function(){return jQuery(this).siblings("input").val(""),jQuery(this).siblings("i").attr("class",""),!1})}e(document).ready(function(){n.menu_item_mouseup(),n.megamenu_status_update(),n.update_megamenu_fields(),e(".remove-mk-megamenu-background").manage_thumbnail_display(),e(".mk-megamenu-background-image").css("display","block"),e(".mk-megamenu-background-image[src='']").css("display","none"),i()});var n={menu_item_mouseup:function(){e(document).on("mouseup",".menu-item-bar",function(i,t){e(i.target).is("a")||setTimeout(n.update_megamenu_fields,300)})},megamenu_status_update:function(){e(document).on("click",".edit-menu-item-mk-megamenu-check",function(){var i=e(this).parents(".menu-item:eq( 0 )");e(this).is(":checked")?i.addClass("mk-megamenu"):i.removeClass("mk-megamenu"),n.update_megamenu_fields()})},update_megamenu_fields:function(){var i=e(".menu-item");i.each(function(t){var a=e(".edit-menu-item-mk-megamenu-check",this);if(e(this).is(".menu-item-depth-0"))a.attr("checked")&&e(this).addClass("mk-megamenu");else{var n=i.filter(":eq("+(t-1)+")");n.is(".mk-megamenu")?(a.attr("checked","checked"),e(this).addClass("mk-megamenu")):(a.attr("checked",""),e(this).removeClass("mk-megamenu"))}})}};e.fn.manage_thumbnail_display=function(i){var t;return this.click(function(i){i.preventDefault(),t=this.id.replace("mk-media-remove-",""),e("#edit-menu-item-megamenu-background-"+t).val(""),e("#mk-media-img-"+t).attr("src","").css("display","none")})},t(),a()}(jQuery);